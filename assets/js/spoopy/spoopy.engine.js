define("spoopy.engine",["underscore","jquery","pubsub"],(e,n,i)=>{"use strict";function t(e){if(!(this instanceof t))throw new TypeError("Engine constructor cannot be called as function!");this.adjacency={},this.exclusions=[],this.available=e}return t.DEFAULT_STARTING_LOCATION="Foyer",t.prototype.constructor=t,t.prototype.engine_get_room=function(){let n=e.filter(this.available,e=>!this._.contains(this.exc,e),{exc:this.exclusions,_:e});if(n.length>0){return e.sample(n)}},t.prototype.engine_update_exclusions=function(n){return e.chain(this.exclusions).union(n).unique().value()},t.prototype.engine_update_adjacency=function(n,i){void 0===this.adjacency[n]&&(this.adjacency[n]=[]),void 0===this.adjacency[i]&&(this.adjacency[i]=[]),this.adjacency[n].push(i),this.adjacency[i].push(n),this.adjacency[n]=e.unique(this.adjacency[n]),this.adjacency[i]=e.unique(this.adjacency[i])},t.prototype.engine_get_branches=function(n){return e.chain(this.adjacency).filter(function(e){return e.toString()!==this.t.toString()},{t:n}).first().value()},t.prototype.engine_build_at=function(n,i){for(let t in e.range(e.isFunction(i)?i():i)){let e=this.engine_get_room();if(void 0===e){console.log("engine_build_at(): error, no available rooms");break}this.engine_update_adjacency(n,e),this.engine_update_exclusions([e])}},t.prototype.engine_build_map=function(e){this.engine_update_exclusions([e]),console.log("engine_build_map(): start ->",this.adjacency,this.exclusions),this.engine_build_at(e,4),console.log("engine_build_map(): complete ->",this.adjacency,this.exclusions)},t});