"use strict";require.config({paths:{jquery:"../jquery.min",underscore:"../underscore.min",pubsub:"../pubsub"}}),define(["jquery","underscore","pubsub","spoopy.rooms","spoopy.items","spoopy.player"],(e,n,o,s,r,i)=>{this.player=new i,e(document).ready(()=>{g(this.player),n.mapObject(s.rooms,n=>e("#nav ul").append(t(n)))});let t=n=>e("<li>").html(e("<a>",{text:n.name,href:"#",click:()=>o.publish("ENGINE_NAV_CLICK",n.name)})),l=(e,o)=>{let s;for(console.log("engine_get_room():",o);void 0===s;){let r=n.filter(e,function(e){return!this._.contains(this.exc,e)},{exc:o,_:n});if(!(r.length>0)){console.error("engine_get_room(): no valid rooms");break}s=n.sample(r)||void 0}return console.log("engine_get_room():",n.contains(o,s),s),s};(e=>{let o=n.range(10),s={},r=((e,o,s,r)=>{let i=[],t=[e];for(let e in n.range(o)){let e=l(s,n.union(t,r));void 0!==e?(i.push(e),t.push(e),console.log("engine_generate_room_connections():",e,t)):console.error("engine_generate_room_connections(): undefined from new_conn generator.")}return{connections:i,exclusions:n.union(r,t)}})(0,n(4),o,[]);s[0]=r.connections,((e,o)=>{console.log("engine_generate_missing_edges(): looking at",e[o]);for(let s in e[o]){let r=e[o][s];console.log("engine_generate_missing_edges(): building missing edges for",r),n.has(e,r)||(e[r]=[]),n.find(e[r],o)?console.log("engine_generate_missing_edges(): edge already exists"):e[r].push(o)}})(s,0),console.log(s)})(s.rooms);let g=n=>{e("#header h1").text(n.loc),e("#content p").text(s.get_description(n.loc))};o.subscribe("ENGINE_NAV_CLICK",(e,n)=>g(this.player))});